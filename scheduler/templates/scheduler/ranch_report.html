<!-- templates/scheduler/ranch_report.html -->
{% extends "base_generic.html" %}

{% block content %}
<h1>Report for Ranch: {{ ranch.name }}</h1>

<form method="post" class="form-inline">
    {% csrf_token %}
    <div class="form-group">
        <label for="from_date">From:</label>
        {{ form.from_date }}
    </div>
    <div class="form-group">
        <label for="to_date">To:</label>
        {{ form.to_date }}
    </div>
    <button type="submit" class="btn btn-primary">Filter</button>
</form>

<button onclick="window.print()" class="btn btn-secondary">Print Report</button>

<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Day</th>
            <th>Well</th>
            <th>Set</th>
            <th>Block</th>
            <th>Acres</th>
            <th>Hours</th>
        </tr>
    </thead>
    <tbody>
        {% for day_data in report_data %}
            {% for history in day_data.histories %}
            <tr>
                {% if forloop.first %}
                <td rowspan="{{ day_data.histories.count }}">{{ day_data.date }}</td>
                <td rowspan="{{ day_data.histories.count }}">{{ day_data.day }}</td>
                {% endif %}
                <td>{{ history.well.name }}</td>
                <td>{{ history.block.set.number }}</td>
                <td>{{ history.block.name }}</td>
                <td>{{ history.block.acreage }}</td>
                <td>{{ history.minutes_irrigated|floatformat:2 }}</td>
            </tr>
            {% endfor %}
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'ranch_detail' ranch.id %}" class="btn btn-secondary">Back to Ranch</a>

<style>
    @media print {
        form, .btn {
            display: none;
        }
        table {
            width: 100%;
        }
    }
</style>

{% endblock %}
